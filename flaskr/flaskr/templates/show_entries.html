{% extends "layout.html" %}
{% block body %}
  

    <link href="{{ url_for('static', filename='css/font-awesome.min.css') }}" rel="stylesheet" />
	
	<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	
	<link rel="stylesheet" href="{{ url_for('static', filename='css/mui.min.css') }}" />
	<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
	<link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet" media="screen" >		
	<link href="{{ url_for('static', filename='css/bootstrap.css') }}" rel="stylesheet" media="screen">
	
	<!-- FONT AWESOME CSS -->
	<link href="{{ url_for('static', filename='css/shadow.css') }}" rel="stylesheet"/>   
	
	
		<style>
			#circle1 {
			    width: 100px;
			    height: 100px;
			    -moz-border-radius: 50px;
			    -webkit-border-radius: 50px;
			    border-radius: 50px;
				font-family: "微软雅黑";
				color: white;
				font-weight: bolder;
			}
			
			.grad-success {
			    filter:alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#5BB92F;,endcolorstr=white,gradientType=0);
			    -ms-filter:alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#5BB92F;,endcolorstr=white,gradientType=0);/*IE8*/	
			    background:#5BB92F; /* 一些不支持背景渐变的浏览器 */  
			    background:-moz-linear-gradient(top, #5BB92F;rgba(255, 255, 255, 0));  
			    background:-webkit-gradient(linear, 0 0, 0 bottom, from(#5BB92F), to(rgba(255, 255, 255, 0)));  
			    background:-o-linear-gradient(top, #5BB92F, rgba(255, 255, 255, 0)); 
			}
			
			.grad-danger {
			    filter:alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#dd524d,endcolorstr=white,gradientType=0);
			    -ms-filter:alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#dd524d,endcolorstr=white,gradientType=0);/*IE8*/	
			    background:#dd524d; /* 一些不支持背景渐变的浏览器 */  
			    background:-moz-linear-gradient(top, #dd524d rgba(255, 255, 255, 0));  
			    background:-webkit-gradient(linear, 0 0, 0 bottom, from(#dd524d), to(rgba(255, 255, 255, 0)));  
			    background:-o-linear-gradient(top, #dd524d, rgba(255, 255, 255, 0)); 
			}		

			.grad-info {
			    filter:alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#31708f,endcolorstr=white,gradientType=0);
			    -ms-filter:alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#31708f,endcolorstr=white,gradientType=0);/*IE8*/	
			    background:#31708f; /* 一些不支持背景渐变的浏览器 */  
			    background:-moz-linear-gradient(top, #31708f rgba(255, 255, 255, 0));  
			    background:-webkit-gradient(linear, 0 0, 0 bottom, from(#31708f), to(rgba(255, 255, 255, 0)));  
			    background:-o-linear-gradient(top, #31708f, rgba(255, 255, 255, 0)); 
			}
			
			.grad-alert-info{
			    filter:alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#d9edf7,endcolorstr=white,gradientType=0);
			    -ms-filter:alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#d9edf7,endcolorstr=white,gradientType=0);/*IE8*/	
			    background:#d9edf7; /* 一些不支持背景渐变的浏览器 */  
			    background:-moz-linear-gradient(top, #d9edf7 rgba(255, 255, 255, 0));  
			    background:-webkit-gradient(linear, 0 0, 0 bottom, from(#d9edf7), to(rgba(255, 255, 255, 0)));  
			    background:-o-linear-gradient(top, #d9edf7, rgba(255, 255, 255, 0)); 				
			}
			
			
			.grad-warning{
			    filter:alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#c67605,endcolorstr=white,gradientType=0);
			    -ms-filter:alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#c67605,endcolorstr=white,gradientType=0);/*IE8*/	
			    background:#c67605; /* 一些不支持背景渐变的浏览器 */  
			    background:-moz-linear-gradient(top, #c67605 rgba(255, 255, 255, 0));  
			    background:-webkit-gradient(linear, 0 0, 0 bottom, from(#c67605), to(rgba(255, 255, 255, 0)));  
			    background:-o-linear-gradient(top, #c67605, rgba(255, 255, 255, 0)); 				
			}
						
 			.grad-round{  

				background: -webkit-radial-gradient(white,white, #050505); /* Safari 5.1 - 6.0 */  background: -o-radial-gradient(red, green, blue); /* Opera 11.6 - 12.0 */  
				
				background: -moz-radial-gradient(white,white, #050505); /* Firefox 3.6 - 15 */ 
				
				background: radial-gradient(white,white, #050505); /* 标准的语法 */ 
							
			}
			body{
				
				background-image: url({{ url_for('static', filename='images/bg44.png') }});
				
				background-repeat: round;	
			}
				
		</style>
	
	
	<nav class="mui-bar mui-bar-tab" style="background-color: #050505;">
		<a class="mui-tab-item mui-active" href="#tabbar">
			<span class="mui-icon mui-icon-home-filled"></span>
			<span class="mui-tab-label">首页</span>
		</a>
		<a class="mui-tab-item" href="#tabbar-with-waiting">
			<span class="mui-icon mui-icon-more-filled"><span class="mui-badge">{{ entries_for_15_days.count() + entries_for_30_days.count() + entries_for_jsbz_zt_0.count() }}</span></span>
			<span class="mui-tab-label">等待中</span>
		</a>
		<a class="mui-tab-item" href="#tabbar-with-handle">
			<span class="mui-icon mui-icon-gear-filled"><span class="mui-badge">{{ entries_waiting_in_tgbz_obj|length }}</span></span>
			<span class="mui-tab-label">代办理</span>
		</a>
		<a class="mui-tab-item" href="#tabbar-with-Inprogress">
			<span class="mui-icon mui-icon-contact-filled"><span class="mui-badge">{{ entries_waiting_in_jsbz_obj|length + entries_waiting_in_jsbz_zt_0|length }}</span></span>
			<span class="mui-tab-label">进行中</span>
		</a>
		<a class="mui-tab-item" href="#tabbar-with-done">
			<span class="mui-icon mui-icon-checkbox-filled"><span class="mui-badge">{{ entries_closed_in_tgbz.count() + entries_closed_in_jsbz.count() }}</span></span>
			<span class="mui-tab-label">已完成</span>
		</a>			
	</nav>
	
	
	<div class=" ">
			<div id="tabbar" class="mui-control-content mui-active" >
		    	<div class="row noti-div" style="height: 80px;">
	    		    <div class="col-lg-4 col-md-4 col-sm-4 text-center" style="width: 49%;float: left;margin-left:2px;">
	                    <a href="{{ url_for('investment') }}">
	                        <div class=" alert-success box-shadow-2-green grad-success" style="height:85px;">
	                            <i class="fa fa-cloud-upload fa-4x"></i><br>
	                            <span class="label btn-success grad-success" style="font-size:16px;">提供帮助</span>                           
	                        </div>
	                    </a>
	                </div>
	                <div class="col-lg-4 col-md-4 col-sm-4 text-center" style=" width: 49%;float: left;margin-right:2px;">
	                    <a href="{{ url_for('receive_help') }}">
	                        <div class=" alert-success box-shadow-2-green grad-success" style="height:85px;">
	                            <i class="fa fa-user fa-4x"></i>
	                            <br>
	                            <span class="label btn-success grad-success" style="font-size:16px;">得到帮助</span>                           
	                           
	                        </div>
	                    </a>
	                </div>
		    	</div>

		    	<div class="row noti-div text-center" >
	                    <a href="{{ url_for('static_purse') }}">
	                            <button type="button" class="btn btn-lg btn-warning grad-warning box-shadow-2-yellow" style="" id='circle1'>静态钱包<br><font size="2px" c>--------<br>{{ cur_user.UE_money|string }}</font></button>                           
	                    </a>
	            </div>

	            <p></p>
		    	<div class="row noti-div text-center">
	                    <a href="{{ url_for('dynamic_purse') }}">
	                            <button type="button" class="btn btn-lg btn-danger grad-danger box-shadow-2-red" id='circle1'>动态钱包<br><font size="2px">--------<br>{{ cur_user.tj_he|string }}</font></button>                           
	                    </a>
	            </div>	
				 <p></p>
	            <div class="row noti-div text-center" >
	                    <a href="{{ url_for('group_management') }}">
	                            <button type="button" class="btn btn-lg btn-info grad-info box-shadow-2-blue" style="">团队管理</button>                           
	                    </a>
	                    <span>&nbsp;&nbsp;</span>
	                    <a href="{{ url_for('personal_information') }}">
	                            <button type="button" class="btn btn-lg btn-info grad-info box-shadow-2-blue" style="">个人信息</button>                           
	                    </a>
	            </div>	            
			</div>
			
			<div id="tabbar-with-waiting" class="mui-control-content" style="font-family: '微软雅黑';">
				<div class="row noti-div text-center" >
		        	<h4>提供帮助&nbsp;<span class="label label-warning">待匹配（15天）</span></h4>
					<div class="table-responsive">  
						<table class="table table-striped table-bordered table-hover" >
		                      <thead>
		                        <tr>
		                          <th style="text-align: center;">金额</th>
		                          <th style="text-align: center;">日期</th>
		                        </tr>
		                      </thead>
			  				  <tbody>
								{% for entry in entries_for_15_days %}
								<tr>
									<td><span class="label label-success">{{ entry.jb }}</span></td>
									<td><span class="label label-info">{{ entry.date }}</span></td>
								</tr>
								{% endfor %}
			  				  </tbody>
						</table>
					</div>  
	            </div>
				
				<div class="row noti-div text-center" >
		        	<h4>提供帮助&nbsp;<span class="label label-warning">待匹配（30天）</span></h4>
					<div class="table-responsive">  
						<table class="table table-striped table-bordered table-hover" >
		                      <thead>
		                        <tr>
		                          <th style="text-align: center;">金额</th>
		                          <th style="text-align: center;">日期</th>
		                        </tr>
		                      </thead>
			  				  <tbody>		
		                        {% for entry in entries_for_30_days %}
								<tr>
									<td><span class="label label-success">{{ entry.jb }}</span></td>
									<td><span class="label label-info">{{ entry.date }}</span></td>
								</tr>
								{% endfor %}
				
			  				  </tbody>
						</table>
					</div>  	            
	            
				</div>
				
				<div class="row noti-div text-center" >
		        	<h4>接受帮助&nbsp;<span class="label label-warning">待匹配</span></h4>
					<div class="table-responsive">  
						<table class="table table-striped table-bordered table-hover" >
		                      <thead>
		                        <tr>
		                          <th style="text-align: center;">金额</th>
		                          <th style="text-align: center;">日期</th>
		                        </tr>
		                      </thead>
			  				  <tbody>		
		                        {% for entry in entries_for_jsbz_zt_0 %}
								<tr>
									<td><span class="label label-success">{{ entry.jb }}</span></td>
									<td><span class="label label-info">{{ entry.date }}</span></td>
								</tr>
								{% endfor %}
				
			  				  </tbody>
						</table>
					</div>  	            
	            
				</div>
				
					<div><br></div>
					<div><br></div>	
	            </div>
				<div id="tabbar-with-handle" class="mui-control-content" style="font-family: '微软雅黑';">
				<div class="row noti-div text-center" >
				
		        	<h4>待办理</h4>
					<div class="table-responsive">  
						<table class="table table-striped table-bordered table-hover">
		                      <thead>
		                        <tr>
		                          <th style="text-align: center;">金额</th>
		                          <th style="text-align: center;">日期</th>
		                          <th style="text-align: center;">详细信息</th>
		                          <th style="text-align: center;">我要操作</th>
		                        </tr>
		                      </thead>
			  				  <tbody>
								{% for entry in entries_waiting_in_tgbz_obj %}					  
								<tr>
								  <td><span class="label label-success">{{ entry[0].jb }}</span></td>
								  <td>
									<span class="label label-info">{{ entry[0].date }}</span>
								  </td>
								  <td><span class="label label-warning"><a href="{{ url_for('entry_waiting_detail', entry_id=entry[0].id) }}">详细信息</a></span></td>
								  <td>
									<span class="label label-warning"><a href="{{ url_for('entry_waiting_operation', entry_id=entry[0].id) }}">我要操作</a></span>
									<span class="label label-important my_time" style="display:none">{{ entry[1].date }}</span>
								  </td>
								</tr>
								{% endfor %}	
			  				  </tbody>
						</table>
					</div> 
				</div>
				
				<div><br></div>
				<div><br></div>	
			</div>
			
			<div id="tabbar-with-Inprogress" class="mui-control-content" style="font-family: '微软雅黑';">
				<div class="row noti-div text-center" >
		        	<h4>进行中-待操作</span></h4>
					<div class="table-responsive">  
						<table class="table table-striped table-bordered table-hover">
		                    <thead>
		                      	<tr>
			                        <th style="text-align: center;">金额</th>
			                        <th style="text-align: center;">日期</th>
			                        <th style="text-align: center;">我要操作</th>
		                      	</tr>
		                    </thead>
			  				<tbody>		
		                        {% for entry in entries_waiting_in_jsbz_obj %}					  
								<tr>
								  <td><span class="label label-success">{{ entry[0].jb }}</span></td>
								  <td>
									<span class="label label-info">{{ entry[0].date }}</span>
								  </td>
								  <td>
									<span class="label label-warning"><a href="{{ url_for('entry_waiting_in_jsbz_operation', entry_id=entry[0].id) }}">我要操作</a></span>
									<span class="label label-important my_time" style="display:none">{{ entry[1].date_hk }}</span>
								  </td>
								</tr>
								{% endfor %}
			  				</tbody>
						</table>
					</div> 
					
					<h4>进行中-已匹配</span></h4>
					<div class="table-responsive">  
						<table class="table table-striped table-bordered table-hover">
		                    <thead>
		                      	<tr>
			                        <th style="text-align: center;">金额</th>
			                        <th style="text-align: center;">日期</th>
			                        <th style="text-align: center;">状态</th>
		                      	</tr>
		                    </thead>
			  				<tbody>		
		                        {% for entry in entries_waiting_in_jsbz_zt_0 %}					  
								<tr>
								  <td><span class="label label-success">{{ entry.jb }}</span></td>
								  <td>
									<span class="label label-info">{{ entry.date }}</span>
								  </td>
								  <td>
									<span class="label label-warning"><span class="label label-warning"><a href="{{ url_for('entry_ongoing_detail', entry_id=entry.id) }}">详细信息</a></span></span>
								  </td>
								</tr>
								{% endfor %}
			  				</tbody>
						</table>
					</div> 
				</div>
				
				<div><br></div>
				<div><br></div>	
			</div>	
			
			
			<div id="tabbar-with-done" class="mui-control-content" style="font-family: '微软雅黑';">
				<div class="row noti-div text-center" >
		        	<h4>已完成</h4>
					
					<h5>已完成-提供帮助</h5>
					<div class="table-responsive">  
						<table class="table table-striped table-bordered table-hover">
							  <thead>
								<tr>
								  <th>金额</th>
								  <th>日期</th>
								</tr>
							  </thead>
							  <tbody>		
								{% for entry in entries_closed_in_tgbz %}				  
								<tr>
								  <td><span class="label label-success">{{ entry.jb }}</span></td>
								  <td><span class="label label-info">{{ entry.date }}</span></td>
								</tr>
								{% endfor %}	
				
							  </tbody>
						</table>
					</div>
					
					<h5>已完成-接受帮助</h5>
					<div class="table-responsive">  
						<table class="table table-striped table-bordered table-hover">
							  <thead>
								<tr>
								  <th>金额</th>
								  <th>日期</th>
								</tr>
							  </thead>
							  <tbody>		
								{% for entry in entries_closed_in_jsbz %}				  
								<tr>
								  <td><span class="label label-success">{{ entry.jb }}</span></td>
								  <td><span class="label label-info">{{ entry.date }}</span></td>
								</tr>
								{% endfor %}	
				
							  </tbody>
						</table>
					</div>
				</div>
				
				<div><br></div>
				<div><br></div>	
			</div>	
	
	
</div> 
  
<script src="{{ url_for('static', filename='js/mui.min.js') }}"></script>
	

<script type="text/javascript">


function timer(intDiff, tag){
	// Note: intDiff is supposed to be of unit millisecond.
	var __tmp = function(){
		var day=0,
			hour=0,
			minute=0,
			second=0;//时间默认值        
		if(intDiff > 0){
			day = Math.floor(intDiff / (60 * 60 * 24));
			hour = Math.floor(intDiff / (60 * 60)) - (day * 24);
			minute = Math.floor(intDiff / 60) - (day * 24 * 60) - (hour * 60);
			second = Math.floor(intDiff) - (day * 24 * 60 * 60) - (hour * 60 * 60) - (minute * 60);
		}
		if (minute <= 9) minute = '0' + minute;
		if (second <= 9) second = '0' + second;
		$('.day_show' + tag).html('<s></s>'+day+"天");
		$('.hour_show' + tag).html('<s></s>'+hour+'时');
		$('.minute_show' + tag).html('<s></s>'+minute+'分');
		$('.second_show' + tag).html('<s></s>'+second+'秒');
		intDiff--;
    };
	__tmp();
    window.setInterval(__tmp, 1000);
} 

function getDateTime() {
    var now     = new Date(); 
    var year    = now.getFullYear();
    var month   = now.getMonth()+1; 
    var day     = now.getDate();
    var hour    = now.getHours();
    var minute  = now.getMinutes();
    var second  = now.getSeconds(); 
    if(month.toString().length == 1) {
        var month = '0'+month;
    }
    if(day.toString().length == 1) {
        var day = '0'+day;
    }   
    if(hour.toString().length == 1) {
        var hour = '0'+hour;
    }
    if(minute.toString().length == 1) {
        var minute = '0'+minute;
    }
    if(second.toString().length == 1) {
        var second = '0'+second;
    }   
    var dateTime = year+'-'+month+'-'+day+' '+hour+':'+minute+':'+second;   
     return dateTime;
}

function string2date(s) {
	var arr1 = s.split(" "); 
	var sdate = arr1[0].split('-'); 
	var date = new Date(sdate[0], sdate[1]-1, sdate[2]); 
	var h_m_s = arr1[1].split(':');
	date.setHours(h_m_s[0]);
	date.setMinutes(h_m_s[1]);
	date.setSeconds(h_m_s[2]);
	return date;
}

$(function(){
	$('.my_time').each(function(index){
		console.log('index', index);
		
		$(this).after("&nbsp;<strong class='day_show_tag" + index + "'>0天</strong>" +
			"<strong class='hour_show_tag" + index + "'>0时</strong>" + 
			"<strong class='minute_show_tag" + index + "'>0分</strong>" +
			"<strong class='second_show_tag" + index + "'>0秒</strong>");
	
		var date = string2date($(this).text());
		console.log(date);
		date.setHours(date.getHours() + 12); // 12 hours count-down
		
		//var now = string2date(getDateTime());//new Date();
		var now = new Date();
		console.log(now);
		
		var delta = (date.getTime() - now.getTime()) / 1000;
		console.log('delta', delta);
		timer(delta, '_tag' + index);
	 });
    
}); 
</script>

{% endblock %}