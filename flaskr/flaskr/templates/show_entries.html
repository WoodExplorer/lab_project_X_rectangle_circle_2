{% extends "layout.html" %}
{% block body %}
  

    <link href="{{ url_for('static', filename='css/font-awesome.min.css') }}" rel="stylesheet" />
	
	<br />
<section>
        <div class="container">
            <div class="row noti-div">
                <div class="col-lg-3 col-md-3 col-sm-3  text-center">
                    <a href="{{ url_for('investment') }}">
                        <div class="alert alert-danger">
                            <i class="fa fa-space-shuttle fa-4x"></i>
                            <br>
                            <span class="label label-info" style="font-size:16px">参与正投资</span>                           
                        </div>
                    </a>
                </div>
				
                <div class="col-lg-3 col-md-3 col-sm-3  text-center">
                    <a href="{{ url_for('static_purse') }}">
                        <div class="alert alert-success">
                            <i class="fa fa-money fa-4x"></i>
                            <br>
                            <span class="label label-warning" style="font-size:16px">静态钱包</span>
                                                       
                        </div>
                    </a>
                </div>
                
                <div class="col-lg-3 col-md-3 col-sm-3  text-center">
                    <a href="{{ url_for('dynamic_purse') }}">
                        <div class="alert alert-warning">
                            <i class="fa fa-recycle fa-4x"></i>
                            <br>
                            <span class="label label-success" style="font-size:16px">动态钱包</span>                         
                        </div>
                    </a>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-3 text-center">
                    <a href="{{ url_for('receive_help') }}">
                        <div class="alert alert-info">
                            <i class="fa fa-cloud-upload fa-4x"></i>
							<br>
                            <span class="label label-danger" style="font-size:16px">得到帮助</span>
                        </div>
                    </a>
                </div>
				<div class="col-lg-3 col-md-3 col-sm-3 text-center">
                    <a href="{{ url_for('group_management') }}">
                        <div class="alert alert-info">
                            <i class="fa fa-group fa-4x"></i>
							<br>
                            <span class="label label-danger" style="font-size:16px">团队管理</span>
                        </div>
                    </a>
                </div>
				<div class="col-lg-3 col-md-3 col-sm-3  text-center">
                    <a href="{{ url_for('personal_information') }}">
                        <div class="alert alert-danger">
                            <i class="fa fa-user fa-4x"></i>
                            <br>
                            <span class="label label-info" style="font-size:16px">个人信息</span>                           
                        </div>
                    </a>
                </div>
            </div>


        </div>

    </section>
 
  <div class="hr-div"> <hr /></div>  


<div class="container">
	<div class="row">
    	<div class="col-lg-9 col-md-9 col-sm-9 ">  
        	<h4>等待中&nbsp;<span class="label label-danger">15天</span></h4>
			
				{% if 0 < entries_for_15_days.count() %}
				<div class="table-responsive">  
					<table class="table table-striped table-bordered table-hover">
						<caption></caption>
						<thead>
							<tr>
								<th>金额</th>
								<th>日期</th>
							</tr>
						</thead>
						<tbody>
						{% for entry in entries_for_15_days %}
						<tr>
							<td><span class="label label-success">{{ entry.jb }}</span></td>
							<td><span class="label label-info">{{ entry.date }}</span></td>
							</tr>
						{% endfor %}
						</tbody>
					</table>
				</div>
				{% else %}
					<em>目前尚无“等待中-15天”类型的记录</em>
				{% endif %}
			    
    	</div>
	</div>
	
	<div class="row">
    	<div class="col-lg-9 col-md-9 col-sm-9 ">  
        	<h4>等待中&nbsp;<span class="label label-danger">30天</span></h4>
			
				{% if 0 < entries_for_30_days.count() %}
				<div class="table-responsive">  
					<table class="table table-striped table-bordered table-hover">
						<caption></caption>
						<thead>
							<tr>
								<th>金额</th>
								<th>日期</th>
							</tr>
						</thead>
						<tbody>
						{% for entry in entries_for_30_days %}
						<tr>
							<td><span class="label label-success">{{ entry.jb }}</span></td>
							<td><span class="label label-info">{{ entry.date }}</span></td>
							</tr>
						{% endfor %}
						</tbody>
					</table>
				</div>
				{% else %}
					<em>目前尚无“等待中-30天”类型的记录</em>
				{% endif %}
			    
    	</div>
	</div>
</div>
  
  
<div class="container">
	<div class="row">
    	<div class="col-lg-9 col-md-9 col-sm-9 ">  
        	<h4>待办理&nbsp;<span class="label label-danger">提供帮助</span></h4>
			{% if 0 < entries_waiting_in_tgbz_obj|length %}
			<div class="table-responsive">  
				<table class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <th>金额</th>
                          <th>日期</th>
						  <th>详细信息</th>
                          <th>我要操作</th>
                        </tr>
                      </thead>
	  				  <tbody>
						{% for entry in entries_waiting_in_tgbz_obj %}					  
                        <tr>
                          <td><span class="label label-success">{{ entry[0].jb }}</span></td>
                          <td>
							<span class="label label-important">{{ entry[0].date }}</span>
						  </td>
						  <td><span class="label label-warning"><a href="{{ url_for('entry_waiting_detail', entry_id=entry[0].id) }}">详细信息</a></span></td>
                          <td>
							<span class="label label-warning"><a href="{{ url_for('entry_waiting_operation', entry_id=entry[0].id) }}">我要操作</a></span>
							<span class="label label-important my_time" style="display:none">{{ entry[1].date }}</span>
						  </td>
                        </tr>
						{% endfor %}
	  				  </tbody>
				</table>
			</div>
			{% else %}
				<em>目前尚无“待办理-提供帮助”类型的记录</em>
			{% endif %}			
    	</div>
	</div>
	
	<div class="row">
    	<div class="col-lg-9 col-md-9 col-sm-9 ">  
        	<h4>待办理&nbsp;<span class="label label-danger">接受帮助</span></h4>
			{% if 0 < entries_waiting_in_jsbz_obj|length %}
			<div class="table-responsive">  
				<table class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <th>金额</th>
                          <th>日期</th>
                          <th>我要操作</th>
                        </tr>
                      </thead>
	  				  <tbody>
						{% for entry in entries_waiting_in_jsbz_obj %}					  
                        <tr>
                          <td><span class="label label-success">{{ entry[0].jb }}</span></td>
                          <td>
							<span class="label label-important">{{ entry[0].date }}</span>
						  </td>
						  <td>
							<span class="label label-warning"><a href="{{ url_for('entry_waiting_in_jsbz_operation', entry_id=entry[0].id) }}">我要操作</a></span>
							<span class="label label-important my_time" style="display:none">{{ entry[1].date_hk }}</span>
						  </td>
                        </tr>
						{% endfor %}
	  				  </tbody>
				</table>
			</div>
			{% else %}
				<em>目前尚无“待办理-接受帮助”类型的记录</em>
			{% endif %}			
    	</div>
	</div>
</div> 

   

<div class="container">
	<div class="row">
    	<div class="col-lg-9 col-md-9 col-sm-9 ">  
        	<h4>已完成&nbsp;<span class="label label-danger">提供帮助</span></h4>
			{% if 0 < entries_closed_in_tgbz.count() %}
			<div class="table-responsive">  
				<table class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <th>金额</th>
                          <th>日期</th>
                        </tr>
                      </thead>
	  				  <tbody>		
                        {% for entry in entries_closed_in_tgbz %}				  
                        <tr>
                          <td><span class="label label-success">{{ entry.jb }}</span></td>
                          <td><span class="label label-info">{{ entry.date }}</span></td>
                        </tr>
						{% endfor %}	
		
	  				  </tbody>
				</table>
			</div>
			{% else %}
				<em>目前尚无“已完成的提供帮助”类型的记录</em>
			{% endif %}
    	</div>
	</div>
    
    <div class="row">
    	<div class="col-lg-9 col-md-9 col-sm-9 ">  
        	<h4>已完成&nbsp;<span class="label label-danger">接受帮助</span></h4>
			{% if 0 < entries_closed_in_jsbz.count() %}
			<div class="table-responsive">  
				<table class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <th>金额</th>
                          <th>日期</th>
                        </tr>
                      </thead>
	  				  <tbody>		
                        {% for entry in entries_closed_in_jsbz %}				  
                        <tr>
                          <td><span class="label label-success">{{ entry.jb }}</span></td>
                          <td><span class="label label-info">{{ entry.date }}</span></td>
                        </tr>
						{% endfor %}	
		
	  				  </tbody>
				</table>
			</div>
			{% else %}
				<em>目前尚无“已完成的接收帮助”类型的记录</em>
			{% endif %}
    	</div>
	</div>
</div> 
  
  

<script type="text/javascript">


function timer(intDiff, tag){
	// Note: intDiff is supposed to be of unit millisecond.
	var __tmp = function(){
		var day=0,
			hour=0,
			minute=0,
			second=0;//时间默认值        
		if(intDiff > 0){
			day = Math.floor(intDiff / (60 * 60 * 24));
			hour = Math.floor(intDiff / (60 * 60)) - (day * 24);
			minute = Math.floor(intDiff / 60) - (day * 24 * 60) - (hour * 60);
			second = Math.floor(intDiff) - (day * 24 * 60 * 60) - (hour * 60 * 60) - (minute * 60);
		}
		if (minute <= 9) minute = '0' + minute;
		if (second <= 9) second = '0' + second;
		$('.day_show' + tag).html('<s></s>'+day+"天");
		$('.hour_show' + tag).html('<s></s>'+hour+'时');
		$('.minute_show' + tag).html('<s></s>'+minute+'分');
		$('.second_show' + tag).html('<s></s>'+second+'秒');
		intDiff--;
    };
	__tmp();
    window.setInterval(__tmp, 1000);
} 

function getDateTime() {
    var now     = new Date(); 
    var year    = now.getFullYear();
    var month   = now.getMonth()+1; 
    var day     = now.getDate();
    var hour    = now.getHours();
    var minute  = now.getMinutes();
    var second  = now.getSeconds(); 
    if(month.toString().length == 1) {
        var month = '0'+month;
    }
    if(day.toString().length == 1) {
        var day = '0'+day;
    }   
    if(hour.toString().length == 1) {
        var hour = '0'+hour;
    }
    if(minute.toString().length == 1) {
        var minute = '0'+minute;
    }
    if(second.toString().length == 1) {
        var second = '0'+second;
    }   
    var dateTime = year+'-'+month+'-'+day+' '+hour+':'+minute+':'+second;   
     return dateTime;
}

function string2date(s) {
	var arr1 = s.split(" "); 
	var sdate = arr1[0].split('-'); 
	var date = new Date(sdate[0], sdate[1]-1, sdate[2]); 
	var h_m_s = arr1[1].split(':');
	date.setHours(h_m_s[0]);
	date.setMinutes(h_m_s[1]);
	date.setSeconds(h_m_s[2]);
	return date;
}

$(function(){
	$('.my_time').each(function(index){
		console.log('index', index);
		
		$(this).after("&nbsp;<strong class='day_show_tag" + index + "'>0天</strong>" +
			"<strong class='hour_show_tag" + index + "'>0时</strong>" + 
			"<strong class='minute_show_tag" + index + "'>0分</strong>" +
			"<strong class='second_show_tag" + index + "'>0秒</strong>");
	
		var date = string2date($(this).text());
		console.log(date);
		date.setHours(date.getHours() + 12); // 12 hours count-down
		
		//var now = string2date(getDateTime());//new Date();
		var now = new Date();
		console.log(now);
		
		var delta = (date.getTime() - now.getTime()) / 1000;
		console.log('delta', delta);
		timer(delta, '_tag' + index);
	 });
    
}); 
</script>

{% endblock %}